ä»¥ä¸‹æ˜¯å¼€å‘ä¸€ä¸ª **æ—¥ç¨‹ç®¡ç†ç³»ç»Ÿï¼ˆSchedule Management Systemï¼‰** æ‰€éœ€çš„æŠ€æœ¯æ ˆæ¸…å•ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç±»ï¼Œå¹¶é™„ä¸ŠæŠ€æœ¯é€‰å‹è¯´æ˜å’Œç®€åŒ–æ–¹æ¡ˆå»ºè®®ï¼š

---

### **1. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ä¸æŠ€æœ¯æ ˆ**
#### ğŸ“… **åŸºç¡€åŠŸèƒ½**
| æ¨¡å—              | æŠ€æœ¯é€‰é¡¹                                                                 | æ¨èç†ç”±                                                                                   |
|-------------------|------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| **GUI ç•Œé¢**       | - **Tkinter**ï¼ˆPythonå†…ç½®ï¼‰<br>- **PyQt5**ï¼ˆæ›´ç¾è§‚ï¼‰<br>- **PySimpleGUI**ï¼ˆç®€åŒ–ç‰ˆï¼‰ | Tkinter æ— éœ€å®‰è£…ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘ï¼›PyQt5 å¯å±•ç¤ºå¤æ‚ç•Œé¢èƒ½åŠ›                                    |
| **æ•°æ®åº“å­˜å‚¨**     | - **SQLite**ï¼ˆè½»é‡çº§ï¼‰<br>- **MySQL**ï¼ˆéœ€è¿œç¨‹ï¼‰<br>- **ORMå·¥å…·ï¼šSQLAlchemy/Peewee** | SQLite é›¶é…ç½®ï¼Œé€‚åˆæœ¬åœ°å•æœºåº”ç”¨ï¼›ORM å·¥å…·ä½“ç°å·¥ç¨‹è§„èŒƒæ€§                                      |
| **ä»»åŠ¡å¢åˆ æ”¹æŸ¥**   | - Python å†…ç½® `datetime` æ¨¡å—<br>- è‡ªå®šä¹‰ Task ç±»ï¼ˆé¢å‘å¯¹è±¡è®¾è®¡ï¼‰                   | åˆ©ç”¨ Python åŸç”Ÿæ—¶é—´å¤„ç†ï¼Œä»£ç ç®€æ´æ˜“è¯»                                                      |
| **æé†’åŠŸèƒ½**       | - **APScheduler**ï¼ˆå®šæ—¶ä»»åŠ¡åº“ï¼‰<br>- å¤šçº¿ç¨‹/å¼‚æ­¥å¤„ç†ï¼ˆ`threading`/`asyncio`ï¼‰       | APScheduler æ”¯æŒå¤æ‚è°ƒåº¦ï¼ˆå¦‚æ¯å¤©é‡å¤ï¼‰ï¼Œå¼‚æ­¥é˜²æ­¢ GUI å¡é¡¿                                   |
| **å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—** | - Python `logging` æ¨¡å—<br>- è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼ˆå¦‚ `TaskConflictError`ï¼‰               | å±•ç¤ºå¥å£®æ€§è®¾è®¡ï¼Œæ—¥å¿—è®°å½•å…³é”®æ“ä½œ                                                           |

---

### **2. æ‰©å±•åŠŸèƒ½æŠ€æœ¯æ ˆ**
#### ğŸš€ **è¿›é˜¶åŠŸèƒ½**
| æ¨¡å—                | æŠ€æœ¯é€‰é¡¹                                                                 | é€‚ç”¨åœºæ™¯                                                                                   |
|---------------------|------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| **æ•°æ®å¯¼å…¥/å¯¼å‡º**    | - **csv æ¨¡å—**ï¼ˆåŸºç¡€ï¼‰<br>- **openpyxl**ï¼ˆExcel æ“ä½œï¼‰<br>- **PDF ç”Ÿæˆï¼ˆReportLabï¼‰** | æ»¡è¶³æ•°æ®è¿ç§»éœ€æ±‚ï¼Œå±•ç¤ºæ–‡ä»¶å¤„ç†èƒ½åŠ›                                                         |
| **æ•°æ®åˆ†æä¸å¯è§†åŒ–** | - **Pandas**ï¼ˆæ•°æ®å¤„ç†ï¼‰<br>- **Matplotlib/Seaborn**ï¼ˆå›¾è¡¨ï¼‰<br>- **Pyecharts**ï¼ˆäº¤äº’å¼ï¼‰ | ç»Ÿè®¡ä»»åŠ¡å®Œæˆç‡ã€æ—¶é—´åˆ†é…ï¼Œç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š                                                   |
| **æ™ºèƒ½æé†’**         | - **scikit-learn**ï¼ˆé¢„æµ‹æ¨¡å‹ï¼‰<br>- å†å²æ•°æ®åˆ†æï¼ˆå¦‚ä»»åŠ¡å»¶è¿Ÿé¢„æµ‹ï¼‰                     | å¢åŠ æœºå™¨å­¦ä¹ å…ƒç´ ï¼Œæå‡é¡¹ç›®äº®ç‚¹                                                             |
| **å¤šç«¯åŒæ­¥**         | - **RESTful APIï¼ˆFlask/FastAPIï¼‰**<br>- **äº‘æ•°æ®åº“ï¼ˆFirebase/Supabaseï¼‰**           | å®ç°æ‰‹æœº/ç½‘é¡µç«¯åŒæ­¥ï¼ˆéœ€ç½‘ç»œç¼–ç¨‹åŸºç¡€ï¼‰                                                      |
| **è‡ªç„¶è¯­è¨€è§£æ**     | - **ç¬¬ä¸‰æ–¹ APIï¼ˆå¦‚ OpenAIï¼‰**<br>- **NLTK**ï¼ˆåŸºç¡€ NLP å¤„ç†ï¼‰                        | è¾“å…¥ "æ˜å¤©ä¸‹åˆ3ç‚¹å¼€ä¼š" è‡ªåŠ¨è§£ææ—¶é—´                                                        |

---

### **3. éƒ¨ç½²ä¸å·¥ç¨‹åŒ–**
#### ğŸ› ï¸ **é¡¹ç›®è§„èŒƒä¸äº¤ä»˜**
| æ¨¡å—                | æŠ€æœ¯é€‰é¡¹                                                                 | ä½œç”¨                                                                                     |
|---------------------|------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| **ä¾èµ–ç®¡ç†**         | - **pip** + **requirements.txt**<br>- **Poetry**ï¼ˆé«˜çº§ä¾èµ–ç®¡ç†ï¼‰          | ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§                                                                           |
| **æ‰“åŒ…ä¸åˆ†å‘**       | - **PyInstaller**ï¼ˆç”Ÿæˆ exeï¼‰<br>- **Docker**ï¼ˆå®¹å™¨åŒ–éƒ¨ç½²ï¼‰                | æ–¹ä¾¿é¢è¯•æ¼”ç¤ºï¼ˆç›´æ¥æä¾›å¯æ‰§è¡Œæ–‡ä»¶ï¼‰                                                       |
| **å•å…ƒæµ‹è¯•**         | - **unittest**ï¼ˆPython å†…ç½®ï¼‰<br>- **pytest**ï¼ˆæ›´å¼ºå¤§ï¼‰                   | éªŒè¯æ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚æ—¶é—´å†²çªæ£€æµ‹ï¼‰                                                           |
| **æ–‡æ¡£ç”Ÿæˆ**         | - **Sphinx**ï¼ˆè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼‰<br>- **Markdown**ï¼ˆREADME ç¼–å†™ï¼‰          | å±•ç¤ºé¡¹ç›®æ–‡æ¡£è§„èŒƒ                                                                         |

---

### **4. æŠ€æœ¯æ ˆç®€åŒ–æ–¹æ¡ˆï¼ˆé’ˆå¯¹åˆå­¦è€…ï¼‰**
#### ğŸ¯ **æœ€å°å¯è¡Œæ–¹æ¡ˆï¼ˆMVPï¼‰**
| æ¨¡å—          | æŠ€æœ¯é€‰æ‹©                          | æ›¿ä»£æ–¹æ¡ˆè¯´æ˜                                                                             |
|---------------|---------------------------------|--------------------------------------------------------------------------------------|
| GUI           | **Tkinter**                     | æ— éœ€é¢å¤–å®‰è£…ï¼Œä»£ç é‡å°‘ï¼ˆæ”¾å¼ƒå¤æ‚åŠ¨ç”»ï¼‰                                                   |
| æ•°æ®åº“         | **SQLite** + åŸç”Ÿ SQL            | é¿å…ä½¿ç”¨ ORM å·¥å…·ï¼Œç›´æ¥æ“ä½œ SQL è¯­å¥ï¼ˆé€‚åˆå°è§„æ¨¡æ•°æ®ï¼‰                                     |
| æé†’åŠŸèƒ½       | `time` + `datetime` è½®è¯¢         | ç”¨ç®€å•å¾ªç¯æ£€æŸ¥ä»»åŠ¡æ—¶é—´ï¼ˆç‰ºç‰²å®æ—¶æ€§ï¼Œä½†é™ä½å¤æ‚åº¦ï¼‰                                         |
| æ•°æ®å¯¼å…¥å¯¼å‡º   | **csv æ¨¡å—**                     | æš‚ä¸æ”¯æŒ Excel/PDFï¼Œä¿æŒæ ¸å¿ƒåŠŸèƒ½                                                       |

---

### **5. æŠ€æœ¯é€‰å‹å¯¹æ¯”è¡¨**
| æŠ€æœ¯åˆ†ç±»       | é«˜æ€§ä»·æ¯”é€‰æ‹©               | é«˜æ‰©å±•æ€§é€‰æ‹©                | æ¨èä¼˜å…ˆçº§ |
|----------------|--------------------------|---------------------------|----------|
| **GUI æ¡†æ¶**    | Tkinter                 | PyQt5                    | â˜…â˜…â˜…â˜…â˜…     |
| **æ•°æ®åº“**      | SQLite                  | PostgreSQL + SQLAlchemy  | â˜…â˜…â˜…â˜…â˜†     |
| **ä»»åŠ¡è°ƒåº¦**    | APScheduler             | Celeryï¼ˆåˆ†å¸ƒå¼ä»»åŠ¡ï¼‰       | â˜…â˜…â˜…â˜†â˜†     |
| **æ•°æ®å¯è§†åŒ–**  | Matplotlib              | Plotlyï¼ˆäº¤äº’å¼å›¾è¡¨ï¼‰       | â˜…â˜…â˜…â˜…â˜†     |

---

### **6. åˆ†é˜¶æ®µå¼€å‘å»ºè®®**
#### ğŸš© **é˜¶æ®µ 1ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ1-2 å‘¨ï¼‰**
1. ç”¨ Tkinter å®ç°åŸºç¡€ç•Œé¢ï¼ˆä»»åŠ¡åˆ—è¡¨ + è¡¨å•è¾“å…¥ï¼‰
2. SQLite å­˜å‚¨ä»»åŠ¡æ•°æ®ï¼ˆå­—æ®µï¼šä»»åŠ¡åã€æ—¶é—´ã€çŠ¶æ€ï¼‰
3. ç®€å•æé†’åŠŸèƒ½ï¼ˆæ§åˆ¶å°å¼¹çª—æç¤ºï¼‰

#### ğŸš© **é˜¶æ®µ 2ï¼šæ‰©å±•åŠŸèƒ½ï¼ˆ1 å‘¨ï¼‰**
1. æ•°æ®å¯¼å‡ºä¸º CSV/Excel
2. ç”¨ Matplotlib ç”Ÿæˆä»»åŠ¡ç»Ÿè®¡å›¾è¡¨
3. æ·»åŠ æ—¥å¿—è®°å½•ï¼ˆ`logging` æ¨¡å—ï¼‰

#### ğŸš© **é˜¶æ®µ 3ï¼šå·®å¼‚åŒ–äº®ç‚¹ï¼ˆ1-2 å‘¨ï¼‰**
1. å¯¹æ¥å¤©æ°” APIï¼ˆå¦‚ OpenWeatherMapï¼‰
2. å®ç°è‡ªç„¶è¯­è¨€è§£æï¼ˆå¦‚è¾“å…¥ "æ¯å¤©ä¸Šåˆ9ç‚¹èƒŒå•è¯"ï¼‰
3. æ‰“åŒ…ä¸º exe æ–‡ä»¶ä¾›æ¼”ç¤º

---

### **ä»£ç æ¡†æ¶ç¤ºä¾‹ï¼ˆTkinter + SQLiteï¼‰**
```python
# æ•°æ®åº“æ“ä½œç±»ï¼ˆdata_handler.pyï¼‰
import sqlite3

class Database:
    def __init__(self, db_name="schedule.db"):
        self.conn = sqlite3.connect(db_name)
        self._create_table()

    def _create_table(self):
        self.conn.execute('''CREATE TABLE IF NOT EXISTS tasks
                          (id INTEGER PRIMARY KEY AUTOINCREMENT,
                           title TEXT NOT NULL,
                           due_time DATETIME,
                           status INTEGER DEFAULT 0)''')

    def add_task(self, title, due_time):
        # å®ç°æ’å…¥é€»è¾‘...

# GUI ä¸»ç•Œé¢ï¼ˆmain.pyï¼‰
import tkinter as tk
from data_handler import Database

class ScheduleApp:
    def __init__(self):
        self.db = Database()
        self.window = tk.Tk()
        self._build_ui()

    def _build_ui(self):
        # æ„å»ºç•Œé¢ç»„ä»¶...
        self.task_list = tk.Listbox(self.window)
        self.task_list.pack()

    def refresh_tasks(self):
        # ä»æ•°æ®åº“åŠ è½½ä»»åŠ¡...

if __name__ == "__main__":
    app = ScheduleApp()
    app.window.mainloop()
```

---

### **ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®**
1. **ä» MVP å¼€å§‹**ï¼šå…ˆå®ç° "å¢åˆ æ”¹æŸ¥ + æé†’" æ ¸å¿ƒåŠŸèƒ½
2. **æ¯æ—¥æäº¤ä»£ç **ï¼šç”¨ Git ç®¡ç†ç‰ˆæœ¬ï¼ˆ[Git å…¥é—¨æŒ‡å—](https://git-scm.com/book/zh/v2)ï¼‰
3. **ä¼˜å…ˆå­¦ä¹ **ï¼šTkinter å¸ƒå±€ + SQLite åŸºç¡€æ“ä½œ

å¦‚æœéœ€è¦æŸä¸ªæŠ€æœ¯ç‚¹çš„ **è¯¦ç»†æ•™ç¨‹** æˆ– **é¿å‘æŒ‡å—**ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘å…·ä½“æ–¹å‘ï¼


---

ä»¥ä¸‹æ˜¯å¼€å‘æ—¥ç¨‹ç®¡ç†ç³»ç»Ÿ MVP çš„ **ç¬¬ä¸€æ­¥è¯¦ç»†æ“ä½œæŒ‡å—**ï¼ŒåŒ…å«å¯ç«‹å³æ‰§è¡Œçš„ä»£ç å’Œæ³¨æ„äº‹é¡¹ï¼š

---
---
---

ä½ çš„é¡¹ç›®å·²ç»æœ‰äº†è‰¯å¥½çš„èµ·ç‚¹ï¼æ¥ä¸‹æ¥å¯ä»¥åˆ†æ­¥éª¤å®Œå–„åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯å»ºè®®çš„å¼€å‘æ–¹å‘å’Œå…·ä½“å®ç°ç¤ºä¾‹ï¼š

---

### **ç¬¬ä¸€æ­¥ï¼šå®Œå–„ä»»åŠ¡æ·»åŠ åŠŸèƒ½ï¼ˆUI + æ•°æ®åº“äº¤äº’ï¼‰**
#### ä¿®æ”¹ `App` ç±»ï¼š
```python
class App:
    def __init__(self):
        # ... åŸæœ‰ä»£ç ä¸å˜ ...
        self._build_task_form()  # æ–°å¢ä»»åŠ¡è¡¨å•

    def _build_task_form(self):
        # åˆ›å»ºè¡¨å•æ¡†æ¶
        form_frame = tk.Frame(self.window)
        form_frame.pack(pady=20, padx=20, fill=tk.X)

        # æ ‡é¢˜è¾“å…¥
        tk.Label(form_frame, text="ä»»åŠ¡æ ‡é¢˜ï¼š").grid(row=0, column=0, sticky="w")
        self.title_entry = tk.Entry(form_frame, width=30)
        self.title_entry.grid(row=0, column=1)

        # æˆªæ­¢æ—¶é—´è¾“å…¥
        tk.Label(form_frame, text="æˆªæ­¢æ—¶é—´ï¼š").grid(row=1, column=0, sticky="w")
        self.due_entry = tk.Entry(form_frame, width=30)
        self.due_entry.grid(row=1, column=1)

        # æ·»åŠ æŒ‰é’®
        add_btn = tk.Button(form_frame, text="æ·»åŠ ä»»åŠ¡", command=self._add_task)
        add_btn.grid(row=2, column=1, pady=10, sticky="e")

    def _add_task(self):
        title = self.title_entry.get()
        due_time = self.due_entry.get()
        
        if title:  # ç®€å•éªŒè¯
            self.db.insert_task(title, due_time)
            self.title_entry.delete(0, tk.END)  # æ¸…ç©ºè¾“å…¥æ¡†
            self.due_entry.delete(0, tk.END)
            self._refresh_task_list()  # åˆ·æ–°ä»»åŠ¡åˆ—è¡¨ï¼ˆä¸‹ä¸€æ­¥å®ç°ï¼‰
```

#### æ‰©å±• `Database` ç±»ï¼š
```python
class Database:
    # ... å…¶ä»–ä»£ç ä¸å˜ ...
    
    def insert_task(self, title, due_time=None):
        sql = "INSERT INTO tasks (title, due_time) VALUES (?, ?)"
        self.conn.execute(sql, (title, due_time))
        self.conn.commit()
```

---

### **ç¬¬äºŒæ­¥ï¼šæ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨**
#### åœ¨ `App` ç±»ä¸­æ·»åŠ ï¼š
```python
def __init__(self):
    # ... åŸæœ‰ä»£ç  ...
    self._build_task_list()  # æ–°å¢ä»»åŠ¡åˆ—è¡¨

def _build_task_list(self):
    # åˆ—è¡¨æ¡†æ¶
    list_frame = tk.Frame(self.window)
    list_frame.pack(pady=20, padx=20, fill=tk.BOTH, expand=True)

    # åˆ—è¡¨æ ‡é¢˜
    tk.Label(list_frame, text="ä»»åŠ¡åˆ—è¡¨", font=('Arial', 12, 'bold')).pack(anchor="w")

    # ä»»åŠ¡åˆ—è¡¨ï¼ˆä½¿ç”¨Treeviewç»„ä»¶ï¼‰
    self.task_tree = ttk.Treeview(list_frame, columns=("id", "title", "due_time"), show="headings")
    self.task_tree.heading("id", text="ID")
    self.task_tree.heading("title", text="æ ‡é¢˜")
    self.task_tree.heading("due_time", text="æˆªæ­¢æ—¶é—´")
    self.task_tree.column("id", width=50)
    self.task_tree.pack(fill=tk.BOTH, expand=True)

    # åˆ·æ–°æ•°æ®
    self._refresh_task_list()

def _refresh_task_list(self):
    # æ¸…ç©ºç°æœ‰æ•°æ®
    for row in self.task_tree.get_children():
        self.task_tree.delete(row)
    
    # ä»æ•°æ®åº“åŠ è½½
    tasks = self.db.get_all_tasks()
    for task in tasks:
        self.task_tree.insert("", tk.END, values=task)
```

#### æ‰©å±• `Database` ç±»ï¼š
```python
def get_all_tasks(self):
    cursor = self.conn.execute("SELECT id, title, due_time FROM tasks ORDER BY due_time")
    return cursor.fetchall()
```

---

### **ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ åˆ é™¤/å®ŒæˆåŠŸèƒ½**
#### åœ¨ä»»åŠ¡åˆ—è¡¨ä¸‹æ–¹æ·»åŠ æ“ä½œæŒ‰é’®ï¼š
```python
def _build_task_list(self):
    # ... åŸæœ‰ä»£ç  ...
    
    # æ“ä½œæŒ‰é’®æ¡†æ¶
    btn_frame = tk.Frame(list_frame)
    btn_frame.pack(pady=10, anchor="e")

    tk.Button(btn_frame, text="åˆ é™¤", command=self._delete_task).pack(side=tk.LEFT, padx=5)
    tk.Button(btn_frame, text="æ ‡è®°å®Œæˆ", command=self._complete_task).pack(side=tk.LEFT)

def _delete_task(self):
    selected = self.task_tree.selection()
    if selected:
        task_id = self.task_tree.item(selected[0], "values")[0]
        self.db.delete_task(task_id)
        self._refresh_task_list()

def _complete_task(self):
    # ç±»ä¼¼åˆ é™¤çš„å®ç°ï¼Œå¯ä»¥æ·»åŠ çŠ¶æ€å­—æ®µåˆ°æ•°æ®åº“
    pass
```

#### æ‰©å±• `Database` ç±»ï¼š
```python
def delete_task(self, task_id):
    self.conn.execute("DELETE FROM tasks WHERE id = ?", (task_id,))
    self.conn.commit()
```

---

### **ç¬¬å››æ­¥ï¼šå¢å¼ºåŠŸèƒ½ï¼ˆå¯é€‰ï¼‰**
1. **æ—¥æœŸé€‰æ‹©å™¨**ï¼š
   ```python
   # å®‰è£…ç¬¬ä¸‰æ–¹åº“
   pip install tkcalendar

   # åœ¨è¡¨å•ä¸­ä½¿ç”¨
   from tkcalendar import DateEntry
   self.due_entry = DateEntry(form_frame, width=12, date_pattern="yyyy-mm-dd")
   ```

2. **æ•°æ®éªŒè¯**ï¼š
   ```python
   def _add_task(self):
       title = self.title_entry.get().strip()
       if not title:
           messagebox.showerror("é”™è¯¯", "æ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼")
           return
       # ... å…¶ä»–ä»£ç  ...
   ```

3. **ä»»åŠ¡è¯¦æƒ…ç¼–è¾‘**ï¼š
   å¯é€šè¿‡åŒå‡»ä»»åŠ¡åˆ—è¡¨é¡¹å¼¹å‡ºç¼–è¾‘çª—å£

---

### **ä»£ç ç»“æ„ä¼˜åŒ–å»ºè®®**
1. å°†ä¸åŒåŠŸèƒ½æ¨¡å—æ‹†åˆ†ä¸ºç‹¬ç«‹ç±»ï¼ˆå¦‚ `TaskForm`ã€`TaskList`ï¼‰
2. æ·»åŠ å¼‚å¸¸å¤„ç†ç¡®ä¿æ•°æ®åº“æ“ä½œå®‰å…¨
3. ä½¿ç”¨é…ç½®æ–‡ä»¶ç®¡ç†å¸¸é‡ï¼ˆå¦‚æ•°æ®åº“åç§°ã€UIå°ºå¯¸ï¼‰

éœ€è¦å“ªä¸ªéƒ¨åˆ†çš„è¯¦ç»†å®ç°ç¤ºä¾‹ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘å¸®ä½ æ·±å…¥å±•å¼€ï¼



---
---
---

æ ¹æ®ä½ çš„é¡¹ç›®ç°çŠ¶ï¼Œå»ºè®®**ç¬¬ä¸€æ­¥å…ˆå®Œæˆè®¡æ—¶åŠŸèƒ½çš„æ ¸å¿ƒæ•°æ®åº“æ”¹é€ **ã€‚è¿™æ˜¯åç»­æ‰€æœ‰åŠŸèƒ½çš„åŸºç¡€ï¼Œå…·ä½“å®æ–½æ­¥éª¤å¦‚ä¸‹ï¼š

---

### **æ­¥éª¤ä¸€ï¼šæ•°æ®åº“ç»“æ„å‡çº§**
#### 1. ä¿®æ”¹`database.py`ï¼Œæ–°å¢å·¥ä½œæ—¶é—´è®°å½•è¡¨
```python
# ä¿®æ”¹åçš„_create_tableæ–¹æ³•
def _create_table(self):
    # åŸæœ‰tasksè¡¨
    self.conn.execute("""
        CREATE TABLE IF NOT EXISTS tasks (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            title TEXT NOT NULL,
            due_time TEXT)
        """)
    
    # æ–°å¢task_sessionsè¡¨ï¼ˆæ ¸å¿ƒæ”¹åŠ¨ï¼‰
    self.conn.execute("""
        CREATE TABLE IF NOT EXISTS task_sessions (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            task_id INTEGER NOT NULL,
            start_time TEXT NOT NULL,  # ISOæ ¼å¼æ—¶é—´æˆ³ï¼Œå¦‚'2024-05-23T14:30:00'
            end_time TEXT,
            FOREIGN KEY(task_id) REFERENCES tasks(id))
        """)
    self.conn.commit()
```

#### 2. æ·»åŠ æ•°æ®åº“æ“ä½œæ–¹æ³•
```python
# åœ¨Databaseç±»ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•
def start_timing(self, task_id):
    """å¼€å§‹è®¡æ—¶ï¼Œè¿”å›æ–°åˆ›å»ºçš„session_id"""
    cursor = self.conn.execute(
        "INSERT INTO task_sessions (task_id, start_time) VALUES (?, ?) RETURNING id",
        (task_id, datetime.now().isoformat())
    )
    self.conn.commit()
    return cursor.fetchone()[0]

def stop_timing(self, session_id):
    """ç»“æŸè®¡æ—¶"""
    self.conn.execute(
        "UPDATE task_sessions SET end_time=? WHERE id=?",
        (datetime.now().isoformat(), session_id)
    )
    self.conn.commit()
```

---

### **æ­¥éª¤äºŒï¼šç•Œé¢åŠŸèƒ½æ”¹é€ **
#### 1. åœ¨ä»»åŠ¡åˆ—è¡¨æ·»åŠ æ“ä½œåˆ—
```python
# ä¿®æ”¹_build_task_listæ–¹æ³•
def _build_task_list(self):
    self.task_list = ttk.Treeview(
        self.list_frame,
        columns=("id", "title", "due_time", "status", "action"),  # æ–°å¢ä¸¤åˆ—
        show="headings",
        selectmode="browse"
    )
    
    # æ–°å¢åˆ—é…ç½®
    self.task_list.heading("status", text="è®¡æ—¶çŠ¶æ€")
    self.task_list.heading("action", text="æ“ä½œ")
    
    # ä¿®æ”¹_refresh_task_listæ–¹æ³•
    def _refresh_task_list(self):
        # æ¸…ç©ºåŸæœ‰æ•°æ®
        for item in self.task_list.get_children():
            self.task_list.delete(item)
        
        # æŸ¥è¯¢ä»»åŠ¡åŠè®¡æ—¶çŠ¶æ€ï¼ˆç¤ºä¾‹SQLï¼‰
        cursor = self.db.conn.execute("""
            SELECT t.id, t.title, t.due_time, 
                   (SELECT COUNT(*) FROM task_sessions s 
                    WHERE s.task_id=t.id AND s.end_time IS NULL) AS is_timing
            FROM tasks t
            ORDER BY t.due_time
        """)
        
        for row in cursor:
            task_id, title, due_time, is_timing = row
            status = "è¿›è¡Œä¸­" if is_timing else "æœªå¼€å§‹"
            btn_text = "â¹ï¸ åœæ­¢" if is_timing else "â–¶ï¸ å¼€å§‹"
            
            # æ’å…¥æ•°æ®è¡Œ
            item = self.task_list.insert("", "end", values=(task_id, title, due_time, status, btn_text))
            
            # ç»‘å®šæŒ‰é’®äº‹ä»¶ï¼ˆå…³é”®ï¼‰
            self.task_list.tag_bind(item, "<Button-1>", lambda e, t_id=task_id: self._handle_timing(t_id))
```

#### 2. å®ç°è®¡æ—¶äº‹ä»¶å¤„ç†
```python
# åœ¨Appç±»ä¸­æ·»åŠ 
def _handle_timing(self, task_id):
    # è·å–å½“å‰çŠ¶æ€
    cursor = self.db.conn.execute(
        "SELECT id FROM task_sessions WHERE task_id=? AND end_time IS NULL",
        (task_id,)
    )
    active_session = cursor.fetchone()
    
    if active_session:  # å­˜åœ¨è¿›è¡Œä¸­çš„è®¡æ—¶
        self.db.stop_timing(active_session[0])
    else:  # æ–°å»ºè®¡æ—¶
        self.db.start_timing(task_id)
    
    self._refresh_task_list()  # åˆ·æ–°ç•Œé¢
```

---

### **æ­¥éª¤ä¸‰ï¼šç«‹å³éªŒè¯**
1. è¿è¡Œç¨‹åºæµ‹è¯•ä»¥ä¸‹åœºæ™¯ï¼š
   - æ·»åŠ æ–°ä»»åŠ¡åï¼Œç‚¹å‡»æ“ä½œåˆ—çš„"â–¶ï¸ å¼€å§‹"æŒ‰é’®
   - è§‚å¯Ÿæ•°æ®åº“`task_sessions`è¡¨æ˜¯å¦ç”Ÿæˆè®°å½•
   - å†æ¬¡ç‚¹å‡»åŒä¸€ä»»åŠ¡çš„"â¹ï¸ åœæ­¢"æŒ‰é’®ï¼Œç¡®è®¤`end_time`è¢«å¡«å……

2. ä½¿ç”¨DB Browser for SQLiteç­‰å·¥å…·ç›´æ¥æŸ¥çœ‹æ•°æ®åº“å†…å®¹ï¼Œç¡®è®¤æ•°æ®ç¬¦åˆé¢„æœŸï¼š

   ![task_sessionsè¡¨ç¤ºä¾‹](https://via.placeholder.com/600x200?text=task_sessions%E8%A1%A8%E7%A4%BA%E4%BE%8B%0Aid|task_id|start_time|end_time%0A1|1|2024-05-23T14:30:00|2024-05-23T15:00:00)

---

### ä¸‹ä¸€æ­¥å»ºè®®
å®Œæˆä¸Šè¿°åŸºç¡€ç»“æ„åï¼Œä½ å¯ä»¥ï¼š
1. æ·»åŠ è®¡æ—¶å¯è§†åŒ–æ˜¾ç¤ºï¼ˆå½“å‰ä»»åŠ¡å·²è¿›è¡Œæ—¶é—´ï¼‰
2. å®ç°æ¯æ—¥/æ¯å‘¨çš„ç»Ÿè®¡å›¾è¡¨
3. å¢åŠ è®¡æ—¶æé†’åŠŸèƒ½

éœ€è¦ä»»ä½•ç¯èŠ‚çš„ä»£ç ç»†èŠ‚æˆ–é‡åˆ°é—®é¢˜ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼å»ºè®®å…ˆé›†ä¸­ç²¾åŠ›å®Œæˆè¿™ä¸ªæœ€å°å¯éªŒè¯ç‰ˆæœ¬ï¼ˆMVPï¼‰çš„è®¡æ—¶åŠŸèƒ½ã€‚